log_format json '{'
  '"timestamp": "$time_iso8601",'
  '"network": {"forwarded_ip": "$http_x_forwarded_for"},'
  '"user":{"name":"$remote_user"},'
  '"user_agent":{"original":"$http_user_agent"},'
  '"http":{'
  '  "version": "$server_protocol",'
  '  "request":{'
  '    "body":{"bytes":$body_bytes_sent},'
  '    "bytes": $request_length,'
  '    "method":"$request_method",'
  '    "referrer":"$http_referer"'
  '  },'
  '  "response":{'
  '    "body":{"bytes":$body_bytes_sent},'
  '    "bytes": $bytes_sent,'
  '    "status_code":"$status",'
  '    "time":$request_time'
  '  },'
  '  "upstream": {'
  '    "bytes": $upstream_response_length,'
  '    "status_code":"$upstream_status",'
  '    "time":$upstream_response_time,'
  '    "address": "$upstream_addr",'
  '    "name": "$proxy_upstream_name"'
  '  }'
  '},'
  '"url":{'
  '  "domain":"$host",'
  '  "path":"$uri",'
  '  "query":"$args",'
  '  "original":"$request_uri"'
  '}'
'}';